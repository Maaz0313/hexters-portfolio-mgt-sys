import{m as g,r as v,j as e,L as A,$ as j}from"./Layout-BFS5gtk9.js";import{I as M}from"./ImageGallery-CytOYfza.js";import{A as T,X as $}from"./app-layout-jEZKEoje.js";import{E as L}from"./eye-3SY2YLK7.js";import{S as N}from"./save-DWA_gTmn.js";import{c as R}from"./createLucideIcon-D_KW33HM.js";import"./trash-CWMpZJs9.js";import"./button-DHEMKb3Q.js";import"./index-DP9BSvV7.js";import"./index-DlY1O6XI.js";import"./app-CpvZPBdQ.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],q=R("Upload",B),Z=({portfolioProject:t,brandings:_,industries:w})=>{var b,y;const k=[{title:"Dashboard",href:"/dashboard"},{title:"Portfolio Projects",href:"/dashboard/portfolio-projects"},{title:"Edit",href:`/dashboard/portfolio-projects/${t.id}/edit`}],I=r=>r?new Date(r).toISOString().split("T")[0]:"",{data:o,setData:d,post:S,processing:x,errors:a}=g({_method:"PUT",title:t.title,description:t.description||"",image:null,image_alt:t.image_alt||"",branding_id:((b=t.branding_id)==null?void 0:b.toString())||"",industry_id:((y=t.industry_id)==null?void 0:y.toString())||"",completion_date:I(t.completion_date),is_featured:t.is_featured,is_published:t.is_published,redirect_to:"edit"}),[u,h]=v.useState(t.image?`/storage/${t.image}`:null),i=g({images:[]}),f=g({_method:"DELETE"}),F=g({}),p=v.useRef(null),D=r=>{r.preventDefault(),console.log("Submitting form with data:",o),S(route("admin.portfolio-projects.update",t.id),{forceFormData:!0,onSuccess:()=>{console.log("Portfolio project updated successfully"),u&&u.startsWith("data:")&&h(null)},onError:s=>{console.error("Error updating portfolio project:",s)},preserveScroll:!0,preserveState:!1})},E=r=>{if(r.target.files&&r.target.files[0]){const s=r.target.files[0];d("image",s);const n=new FileReader;n.onload=l=>{var c;h((c=l.target)==null?void 0:c.result)},n.readAsDataURL(s)}},C=r=>{if(r.target.files&&r.target.files.length>0){const s=Array.from(r.target.files);console.log("Files selected:",s),i.setData("images",s)}},U=r=>{r.preventDefault(),console.log("Uploading images:",i.data.images);const s=new FormData;i.data.images.forEach((n,l)=>{s.append(`images[${l}]`,n)}),i.post(route("admin.portfolio-images.store",t.id),{forceFormData:!0,onSuccess:()=>{console.log("Upload successful"),i.reset(),p.current&&(p.current.value="")},onError:n=>{console.error("Upload failed:",n)},preserveScroll:!0,preserveState:!0})};return e.jsxs(T,{breadcrumbs:k,children:[e.jsx(A,{title:`Edit Portfolio Project: ${t.title}`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-card overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"bg-card border-border border-b p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h1",{className:"title-text text-primary text-2xl font-bold",children:"Edit Portfolio Project"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(j,{href:route("admin.portfolio-projects.index"),className:"bg-muted text-muted-foreground hover:bg-muted/80 ring-muted inline-flex cursor-pointer items-center rounded-md border border-transparent px-4 py-2 text-xs font-semibold tracking-widest uppercase transition focus:ring focus:outline-none disabled:opacity-25",children:[e.jsx($,{className:"mr-2 h-4 w-4"}),"Cancel"]}),e.jsxs(j,{href:route("admin.portfolio-projects.show",t.id),className:"bg-accent text-accent-foreground hover:bg-accent/80 ring-accent inline-flex cursor-pointer items-center rounded-md border border-transparent px-4 py-2 text-xs font-semibold tracking-widest uppercase transition focus:ring focus:outline-none disabled:opacity-25",children:[e.jsx(L,{className:"mr-2 h-4 w-4"}),"View"]})]})]}),e.jsxs("form",{onSubmit:D,children:[e.jsx("input",{type:"hidden",name:"redirect_to",value:"edit"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-6 md:col-span-2",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"title",className:"text-card-foreground block text-sm font-medium",children:["Title ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx("input",{type:"text",id:"title",value:o.title,onChange:r=>d("title",r.target.value),className:"border-border bg-background text-card-foreground focus:border-primary focus:ring-primary focus:ring-opacity-50 mt-1 block w-full rounded-md shadow-sm focus:ring",required:!0}),a.title&&e.jsx("p",{className:"text-destructive mt-1 text-sm",children:a.title})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"text-card-foreground block text-sm font-medium",children:"Description"}),e.jsx("textarea",{id:"description",value:o.description,onChange:r=>d("description",r.target.value),rows:3,className:"border-border bg-background text-card-foreground focus:border-primary focus:ring-primary focus:ring-opacity-50 mt-1 block w-full rounded-md shadow-sm focus:ring"}),a.description&&e.jsx("p",{className:"text-destructive mt-1 text-sm",children:a.description})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"branding_id",className:"text-card-foreground block text-sm font-medium",children:"Branding"}),e.jsxs("select",{id:"branding_id",value:o.branding_id,onChange:r=>d("branding_id",r.target.value),className:"border-border bg-background text-card-foreground focus:border-primary focus:ring-primary focus:ring-opacity-50 mt-1 block w-full rounded-md shadow-sm focus:ring",children:[e.jsx("option",{value:"",children:"Select Branding"}),_.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),a.branding_id&&e.jsx("p",{className:"text-destructive mt-1 text-sm",children:a.branding_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"industry_id",className:"text-card-foreground block text-sm font-medium",children:"Industry"}),e.jsxs("select",{id:"industry_id",value:o.industry_id,onChange:r=>d("industry_id",r.target.value),className:"border-border bg-background text-card-foreground focus:border-primary focus:ring-primary focus:ring-opacity-50 mt-1 block w-full rounded-md shadow-sm focus:ring",children:[e.jsx("option",{value:"",children:"Select Industry"}),w.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]}),a.industry_id&&e.jsx("p",{className:"text-destructive mt-1 text-sm",children:a.industry_id})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"completion_date",className:"text-card-foreground block text-sm font-medium",children:"Completion Date"}),e.jsx("input",{type:"date",id:"completion_date",value:o.completion_date,onChange:r=>d("completion_date",r.target.value),className:"border-border bg-background text-card-foreground focus:border-primary focus:ring-primary focus:ring-opacity-50 mt-1 block w-full rounded-md shadow-sm focus:ring"}),a.completion_date&&e.jsx("p",{className:"text-destructive mt-1 text-sm",children:a.completion_date})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"image",className:"text-card-foreground block text-sm font-medium",children:"Main Project Image"}),e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx("input",{type:"file",id:"image",onChange:E,className:"sr-only",accept:"image/*"}),e.jsx("label",{htmlFor:"image",className:"bg-background border-border text-card-foreground hover:bg-muted focus:ring-primary inline-flex cursor-pointer items-center rounded-md border px-4 py-2 text-xs font-semibold tracking-widest uppercase shadow-sm transition focus:ring-2 focus:ring-offset-2 focus:outline-none disabled:opacity-25",children:t.image?"Change Main Image":"Select Main Image"})]}),(u||t.image)&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:u||(t.image?`/storage/${t.image}`:""),alt:"Preview",className:"h-40 w-full rounded-md object-cover",onError:r=>{console.error("Main image failed to load"),r.currentTarget.style.display="none"}})}),a.image&&e.jsx("p",{className:"text-destructive mt-1 text-sm",children:a.image})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"image_alt",className:"text-card-foreground block text-sm font-medium",children:"Main Image Alt Text"}),e.jsx("input",{type:"text",id:"image_alt",value:o.image_alt,onChange:r=>d("image_alt",r.target.value),className:"border-border bg-background text-card-foreground focus:border-primary focus:ring-primary focus:ring-opacity-50 mt-1 block w-full rounded-md shadow-sm focus:ring",placeholder:"Brief description of the main image"}),a.image_alt&&e.jsx("p",{className:"text-destructive mt-1 text-sm",children:a.image_alt})]}),t.images&&t.images.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-card-foreground mb-2 block text-sm font-medium",children:"Project Images"}),e.jsx(M,{images:t.images,editable:!0,onDelete:r=>{const s=t.images.find(m=>m.id===r);if(!s){console.error("Image not found:",r);return}const n=m=>m?m.replace(/^\/+/,"").replace(/^storage\//,""):"",l=n(t.image),c=n(s.image_path);if(console.log("Comparing paths:",{mainImagePath:l,imageToDeletePath:c,originalMainImage:t.image,originalImagePath:s.image_path}),l&&c&&l===c){alert("Cannot delete the main project image. Please change the main image first.");return}if(confirm("Are you sure you want to delete this image?")){if(console.log("Deleting image with ID:",r),f.processing){console.warn("Another deletion is in progress. Please wait.");return}f.delete(route("admin.portfolio-images.destroy",r),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{console.log("Image deleted successfully")},onError:m=>{console.error("Error deleting image:",m)}})}},onSetFeatured:r=>{confirm("Set this image as featured?")&&F.post(route("admin.portfolio-images.set-featured",r),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{console.log("Image set as featured successfully")},onError:s=>{console.error("Error setting image as featured:",s)}})}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_featured",checked:o.is_featured,onChange:r=>d("is_featured",r.target.checked),className:"border-border text-primary focus:border-primary focus:ring-primary focus:ring-opacity-50 rounded shadow-sm focus:ring"}),e.jsx("label",{htmlFor:"is_featured",className:"text-card-foreground ml-2 text-sm",children:"Featured project"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_published",checked:o.is_published,onChange:r=>d("is_published",r.target.checked),className:"border-border text-primary focus:border-primary focus:ring-primary focus:ring-opacity-50 rounded shadow-sm focus:ring"}),e.jsx("label",{htmlFor:"is_published",className:"text-card-foreground ml-2 text-sm",children:t.is_published?"Published":"Publish"})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"submit",disabled:x,className:"bg-primary text-primary-foreground hover:bg-primary/90 ring-primary inline-flex w-full cursor-pointer items-center justify-center rounded-md border border-transparent px-4 py-2 text-xs font-semibold tracking-widest uppercase transition focus:ring focus:outline-none disabled:opacity-25",children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),x?"Saving...":"Update Project"]})})]})]})]}),e.jsxs("div",{className:"border-border mt-6 border-t p-6",children:[e.jsx("h3",{className:"text-card-foreground mb-4 text-lg font-medium",children:"Upload Additional Images"}),e.jsxs("form",{onSubmit:U,children:[e.jsxs("div",{className:"mt-1 flex items-center",children:[e.jsx("input",{type:"file",id:"additional_images",ref:p,className:"sr-only",accept:"image/*",multiple:!0,onChange:C}),e.jsxs("label",{htmlFor:"additional_images",className:"bg-background border-border text-card-foreground hover:bg-muted focus:ring-primary inline-flex cursor-pointer items-center rounded-md border px-4 py-2 text-xs font-semibold tracking-widest uppercase shadow-sm transition focus:ring-2 focus:ring-offset-2 focus:outline-none disabled:opacity-25",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Select Images"]}),e.jsxs("button",{type:"submit",disabled:i.processing||i.data.images.length===0,className:"bg-primary text-primary-foreground hover:bg-primary/90 ring-primary ml-2 inline-flex cursor-pointer items-center rounded-md border border-transparent px-4 py-2 text-xs font-semibold tracking-widest uppercase transition focus:ring focus:outline-none disabled:opacity-25",children:[e.jsx(N,{className:"mr-2 h-4 w-4"}),i.processing?"Uploading...":"Upload Images"]})]}),i.data.images.length>0&&e.jsxs("p",{className:"text-primary mt-2 text-xs",children:[i.data.images.length," ",i.data.images.length===1?"image":"images"," selected"]}),e.jsx("p",{className:"text-secondary mt-2 text-xs",children:'You can select multiple images at once. Images will be uploaded when you click "Upload Images". Max 5MB per image.'}),i.errors.images&&e.jsx("p",{className:"text-destructive mt-1 text-sm",children:i.errors.images})]})]})]})})})})]})};export{Z as default};
